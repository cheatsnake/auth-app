(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{15:function(e,t,n){},29:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){},52:function(e,t,n){},53:function(e,t,n){"use strict";n.r(t),n.d(t,"Context",(function(){return F}));var r=n(1),s=n(10),a=n.n(s),c=n(6),i=(n(29),n(0)),u=function(){return Object(i.jsx)("div",{className:"overlay",children:Object(i.jsx)("div",{className:"spinner"})})},o=(n(31),function(e){var t=e.children;return Object(i.jsx)("button",{type:"submit",className:"btn btn_login",children:t})}),l=function(e){var t=e.children,n=e.func;return Object(i.jsx)("button",{onClick:function(){return n()},className:"btn btn_link",children:t})},h=function(e){var t=e.children,n=e.func;return Object(i.jsx)("button",{onClick:function(){return n()},className:"btn btn_logout",children:t})},j=(n(32),Object(c.a)((function(){var e=Object(r.useContext)(F).store;return Object(i.jsxs)("div",{className:"profile",children:[Object(i.jsx)("h1",{children:"Welcome!"}),Object(i.jsx)("label",{children:"Your email:"}),Object(i.jsx)("input",{type:"text",value:e.user.email,readOnly:!0}),Object(i.jsx)("label",{children:"Email confirmed:"}),Object(i.jsx)("input",{type:"text",value:e.user.isActivated.toString(),readOnly:!0}),Object(i.jsx)(h,{func:function(){return e.logout()},children:"Logout"})]})}))),d=n(7),b=(n(15),Object(c.a)((function(){var e=Object(r.useState)(""),t=Object(d.a)(e,2),n=t[0],s=t[1],a=Object(r.useState)(""),c=Object(d.a)(a,2),u=c[0],h=c[1],j=Object(r.useContext)(F).store;return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("h1",{className:"label",children:"LOG IN"}),Object(i.jsxs)("form",{onSubmit:function(e){return function(e){e.preventDefault(),j.login(n,u)}(e)},className:"form",children:[Object(i.jsx)("label",{children:"Email"}),Object(i.jsx)("input",{onChange:function(e){return s(e.target.value)},value:n,type:"email",maxLength:25,required:!0}),Object(i.jsx)("label",{children:"Password"}),Object(i.jsx)("input",{onChange:function(e){return h(e.target.value)},value:u,type:"password",minLength:6,maxLength:20,required:!0}),Object(i.jsx)("div",{className:"error",children:j.message?j.message:null}),Object(i.jsx)(o,{children:"Login"}),Object(i.jsx)(l,{func:function(){return j.setViewForm("Register"),void j.setMessage("")},children:"New user?"})]})]})}))),p=Object(c.a)((function(){var e=Object(r.useState)(""),t=Object(d.a)(e,2),n=t[0],s=t[1],a=Object(r.useState)(""),c=Object(d.a)(a,2),u=c[0],h=c[1],j=Object(r.useState)(""),b=Object(d.a)(j,2),p=b[0],f=b[1],v=Object(r.useContext)(F).store;return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("h1",{className:"label",children:"NEW USER"}),Object(i.jsxs)("form",{onSubmit:function(e){return function(e){e.preventDefault(),p!==u?(f(""),v.setMessage("The entered passwords do not match")):v.register(n,u)}(e)},className:"form",children:[Object(i.jsx)("label",{children:"Email"}),Object(i.jsx)("input",{onChange:function(e){return s(e.target.value)},value:n,type:"email",maxLength:25,required:!0}),Object(i.jsx)("label",{children:"Password"}),Object(i.jsx)("input",{onChange:function(e){return h(e.target.value)},value:u,type:"password",minLength:6,maxLength:20,required:!0}),Object(i.jsx)("label",{children:"Repeat password"}),Object(i.jsx)("input",{onChange:function(e){return f(e.target.value)},value:p,type:"password",minLength:6,maxLength:20,required:!0}),Object(i.jsx)("div",{className:"error",children:v.message?v.message:null}),Object(i.jsx)(o,{children:"Create"}),Object(i.jsx)(l,{func:function(){return v.setViewForm("Login"),void v.setMessage("")},children:"Are you already registered?"})]})]})})),f=Object(c.a)((function(){var e=Object(r.useContext)(F).store;return Object(r.useEffect)((function(){localStorage.getItem("token")&&e.checkAuth()}),[]),e.isAuth&&e.user.hasOwnProperty("isActivated")?Object(i.jsx)(i.Fragment,{children:Object(i.jsx)(j,{})}):Object(i.jsxs)("div",{className:"app",children:[e.isLoading?Object(i.jsx)(u,{}):null,"Login"===e.viewForm?Object(i.jsx)(b,{}):Object(i.jsx)(p,{})]})})),v=n(3),g=n.n(v),O=n(5),m=n(11),x=n(12),k=n(13),w=n.n(k),y=n(2),L="https://auth-api-pro.herokuapp.com/auth",C=w.a.create({withCredentials:!0,baseURL:L});C.interceptors.request.use((function(e){if(e.headers)return e.headers.Authorization="Bearer ".concat(localStorage.getItem("token")),e}));var N=C,S=function(){function e(){Object(m.a)(this,e)}return Object(x.a)(e,null,[{key:"login",value:function(){var e=Object(O.a)(g.a.mark((function e(t,n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",N.post("/login",{email:t,password:n}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"register",value:function(){var e=Object(O.a)(g.a.mark((function e(t,n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",N.post("/register",{email:t,password:n}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(O.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",N.post("/logout"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),A=function(){function e(){Object(m.a)(this,e),this.user={},this.isAuth=!1,this.viewForm="Login",this.isLoading=!1,this.message="",Object(y.d)(this)}return Object(x.a)(e,[{key:"setAuth",value:function(e){this.isAuth=e}},{key:"setUser",value:function(e){this.user=e}},{key:"setLoading",value:function(e){this.isLoading=e}},{key:"setViewForm",value:function(e){this.viewForm=e}},{key:"setMessage",value:function(e){this.message=e}},{key:"login",value:function(){var e=Object(O.a)(g.a.mark((function e(t,n){var r,s,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setLoading(!0),e.prev=1,e.next=4,S.login(t,n);case 4:r=e.sent,localStorage.setItem("token",r.data.accessToken),this.setAuth(!0),this.setUser(r.data.user),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),this.setMessage(null===(s=e.t0.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message);case 13:return e.prev=13,this.setLoading(!1),this.setMessage(""),e.finish(13);case 17:case"end":return e.stop()}}),e,this,[[1,10,13,17]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"register",value:function(){var e=Object(O.a)(g.a.mark((function e(t,n){var r,s,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setLoading(!0),e.prev=1,e.next=4,S.register(t,n);case 4:r=e.sent,localStorage.setItem("token",r.data.accessToken),this.setAuth(!0),this.setUser(r.data.user),this.setViewForm("Login"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),this.setMessage(null===(s=e.t0.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message);case 14:return e.prev=14,this.setLoading(!1),this.setMessage(""),e.finish(14);case 18:case"end":return e.stop()}}),e,this,[[1,11,14,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(O.a)(g.a.mark((function e(){var t,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S.logout();case 3:localStorage.removeItem("token"),this.setAuth(!1),this.setUser({}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.setMessage(null===(t=e.t0.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message);case 11:return e.prev=11,this.setMessage(""),e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[0,8,11,14]])})));return function(){return e.apply(this,arguments)}}()},{key:"checkAuth",value:function(){var e=Object(O.a)(g.a.mark((function e(){var t,n,r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setLoading(!0),e.prev=1,e.next=4,w.a.get("".concat(L,"/refresh"),{withCredentials:!0});case 4:t=e.sent,localStorage.setItem("token",t.data.accessToken),this.setAuth(!0),this.setUser(t.data.user),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),this.setMessage(null===(n=e.t0.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.message);case 13:return e.prev=13,this.setLoading(!1),this.setMessage(""),e.finish(13);case 17:case"end":return e.stop()}}),e,this,[[1,10,13,17]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),M=(n(52),new A),F=Object(r.createContext)({store:M});a.a.render(Object(i.jsx)(F.Provider,{value:{store:M},children:Object(i.jsx)(f,{})}),document.getElementById("root"))}},[[53,1,2]]]);
//# sourceMappingURL=main.5c142dc4.chunk.js.map